entities:
  TEST_DATA:
    source_database: BIGQUERY
    table_name: austin_crime
    dataset_name: <dataset_id>
    project_name: clouddq-pbalm
    columns:
      UNIQUE_KEY:
        name: unique_key
        data_type: INTEGER
      DESCRIPT:
        name: descript
        data_type: STRING
      DATE:
        name: date
        data_type: DATE
      TIME:
        name: time
        data_type: TIME
      ADDRESS:
        name: address
        data_type: STRING
      LON:
        name: longitude
        data_type: FLOAT
      LAT:
        name: latitude
        data_type: FLOAT
      LOCATION:
        name: location
        data_type: STRING
      TIMESTAMP:
        name: timestamp
        data_type: TIMESTAMP
        

rules:
  R_FOREIGN_KEY_VALID:
    rule_type: CUSTOM_SQL_EXPR
    params:
      custom_sql_expr: |-
        $column in (select distinct unique_key from `<dataset_id>.<pk_ref_table_id>`)

row_filters:
  NONE:
    filter_sql_expr: |-
      True
        
rule_bindings:
  FOREIGN_KEY_VALID:
    entity_id: TEST_DATA
    column_id: UNIQUE_KEY
    row_filter_id: NONE
    rule_ids:
      - R_FOREIGN_KEY_VALID
      
      