{
  "rule_binding_id": "<rule_binding_id>",
  "entity_id": "<entity_id>",
  "entity_configs": {
    "source_database": "BIGQUERY",
    "table_name": "contact_details_partitioned",
    "database_name": "<your_bigquery_dataset_id>",
    "instance_name": "<your-gcp-project-id>",
    "columns": {
      "ROW_ID": {
        "name": "row_id",
        "data_type": "STRING"
      },
      "CONTACT_TYPE": {
        "name": "contact_type",
        "data_type": "STRING"
      },
      "VALUE": {
        "name": "value",
        "data_type": "STRING"
      },
      "TS": {
        "name": "ts",
        "data_type": "TIMESTAMP"
      }
    },
    "dataset_name": "<your_bigquery_dataset_id>",
    "project_name": "<your-gcp-project-id>",
    "resource_type": "BIGQUERY",
    "partition_fields": [{"name": "ts",
                          "partitioning_type": "DAY",
                          "type": "TIMESTAMP"}]
  },
  "column_id": "VALUE",
  "column_configs": {
    "name": "value",
    "data_type": "STRING"
  },
  "rule_ids": [
    {
      "NO_DUPLICATES_IN_COLUMN_GROUPS": {
        "column_names": "contact_type,value"
      }
    },
    "NOT_NULL_SIMPLE"
  ],
  "rule_configs_dict": {
    "NO_DUPLICATES_IN_COLUMN_GROUPS": {
      "dimension": null,
      "rule_type": "CUSTOM_SQL_STATEMENT",
      "params": {
        "custom_sql_arguments": [
          "column_names"
        ],
        "custom_sql_statement": "select a.*\nfrom data a\ninner join (\n  select\n    $column_names\n  from data\n  group by $column_names\n  having count(*) > 1\n) duplicates\nusing ($column_names)",
        "rule_binding_arguments": {
          "column_names": "contact_type,value"
        }
      },
      "rule_sql_expr": "select a.*\nfrom data a\ninner join (\n  select\n    contact_type,value\n  from data\n  group by contact_type,value\n  having count(*) > 1\n) duplicates\nusing (contact_type,value)"
    },
    "NOT_NULL_SIMPLE": {
      "dimension": null,
      "rule_type": "NOT_NULL",
      "params": {
        "rule_binding_arguments": null
      },
      "rule_sql_expr": "value IS NOT NULL"
    }
  },
  "row_filter_ids": ["DATA_TYPE_EMAIL"],
  "row_filter_configs": {
    "DATA_TYPE_EMAIL": {
      "filter_sql_expr": "contact_type = 'email'",
      "params": "column"
    }
  },
  "reference_columns_id": "CONTACT_DETAILS_REFERENCE_COLUMNS",
  "include_reference_columns": ["row_id", "contact_type", "value"],
  "include_all_reference_columns": false,
  "incremental_time_filter_column": null,
  "metadata": {
    "brand": "one"
  }
}
